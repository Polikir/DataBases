/* Вывести количество марок автомобилей у которых разность между автомобилем 
имеющим максимальный пробег и минимальный пробег, среди всех моделей 
конкретно взятой марки не превосходило бы 50000.*/

with table_diff as (
select  "Марка", max("Пробег") - min("Пробег") as diff from "ТС"

join "Марка ТС"
on "ТС"."Id Марка ТС" = "Марка ТС"."Id Марка ТС"

group by "Марка"
)

select * from table_diff

where diff <= 50000
